(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[923],{255:(e,t,s)=>{"use strict";function n(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return n}}),s(5155),s(7650),s(5744),s(589)},2146:(e,t,s)=>{"use strict";function n(e){let{reason:t,children:s}=e;return s}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}}),s(5262)},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{bindSnapshot:function(){return a},createAsyncLocalStorage:function(){return r},createSnapshot:function(){return o}});let s=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class n{disable(){throw s}getStore(){}run(){throw s}exit(){throw s}enterWith(){throw s}static bind(e){return e}}let l="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function r(){return l?new l:new n}function a(e){return l?l.bind(e):n.bind(e)}function o(){return l?l.snapshot():function(e,...t){return e(...t)}}},5028:(e,t,s)=>{"use strict";s.d(t,{default:()=>l.a});var n=s(6645),l=s.n(n)},5399:(e,t,s)=>{Promise.resolve().then(s.bind(s,7106))},5744:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return n.workAsyncStorageInstance}});let n=s(7828)},6645:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let n=s(8229)._(s(7357));function l(e,t){var s;let l={};"function"==typeof e&&(l.loader=e);let r={...l,...t};return(0,n.default)({...r,modules:null==(s=r.loadableGenerated)?void 0:s.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7106:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s(5155),l=s(2115);function r(){let[e,t]=(0,l.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:"fixed bottom-6 right-6 z-50 bg-blue-600 hover:bg-blue-500 text-white rounded-full w-12 h-12 shadow-lg focus:outline-none",onClick:()=>t(!e),children:"?"}),e&&(0,n.jsxs)("div",{className:"fixed bottom-20 right-6 z-50 w-72 p-4 bg-black/80 backdrop-blur rounded-xl text-blue-100 text-sm space-y-2 shadow-lg",children:[(0,n.jsx)("div",{className:"text-white font-medium mb-1",children:"Visualizer Help"}),(0,n.jsxs)("p",{children:["• Scroll or pinch to zoom.",(0,n.jsx)("br",{}),"• Drag background to pan.",(0,n.jsx)("br",{}),"• Click a node to view details.",(0,n.jsx)("br",{}),"• Use Play/Pause to animate timeline."]}),(0,n.jsx)("button",{className:"mt-2 px-3 py-1 bg-blue-600 hover:bg-blue-500 rounded text-white text-xs",onClick:()=>t(!1),children:"Close"})]})]})}let a=(0,s(5028).default)(()=>Promise.all([s.e(294),s.e(702),s.e(889),s.e(691)]).then(s.bind(s,8691)),{loadableGenerated:{webpack:()=>[require.resolveWeak("../../../components/GraphView")]},ssr:!1});function o(e){var t,s,o,d,i,u,c;let{params:b}=e,{chainId:h,txHash:x}=b||{},[m,f]=(0,l.useState)(null),[g,p]=(0,l.useState)(!0),[v,j]=(0,l.useState)(null),[y,w]=(0,l.useState)(null),[N,_]=(0,l.useState)([]),[S,k]=(0,l.useState)(0),[P,O]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{async function e(){p(!0);try{let e=await fetch("/api/graph/".concat(h,"/").concat(x)),t=await e.json();if(!t.success)throw Error(t.error||"Failed");f(t.graph)}catch(e){j(e.message),f({chainId:Number(h),txHash:String(x),blocks:{number:0,timestamp:Date.now()/1e3},rootNodeId:"0",nodes:{0:{id:"0",type:"CALL",from:"0xfrom",to:"0xto",functionName:"root",gasUsed:1e4,depth:0,status:"success",children:["1"],logs:[]},1:{id:"1",parentId:"0",type:"CALL",from:"0xto",to:"0xcallee",functionName:"doThing(uint256)",gasUsed:5e3,depth:1,status:"success",children:[],logs:[]}},tokenTransfers:[],gasTotals:{gasUsed:15e3}})}finally{p(!1)}}h&&x&&e()},[h,x]),(0,l.useEffect)(()=>{!async function(){if(h&&x)try{let e=await fetch("/api/replay/".concat(h,"/").concat(x),{method:"POST"}),t=await e.json();t.success&&Array.isArray(t.frames)&&(_(t.frames),t.frames.length>0&&(k(0),w(t.frames[0].nodeId)))}catch(e){if(m){let e=Object.keys(m.nodes||{}).map((e,t)=>{var s;return{step:t,nodeId:e,gasUsedCumulative:Number((null==(s=m.nodes[e])?void 0:s.gasUsed)||0)}});_(e),e.length>0&&(k(0),w(e[0].nodeId))}}}()},[h,x,m]),(0,l.useEffect)(()=>{if(!P||0===N.length)return;let e=setInterval(()=>{k(e=>{let t=(e+1)%N.length,s=N[t];return(null==s?void 0:s.nodeId)&&w(s.nodeId),t})},900);return()=>clearInterval(e)},[P,N]),(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-black via-slate-900 to-blue-950",children:[(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-4",children:[(0,n.jsx)("h1",{className:"text-2xl md:text-3xl font-semibold text-white",children:"Transaction Visualizer"}),(0,n.jsxs)("div",{className:"text-sm text-blue-200 font-mono",children:["Chain ",h," — ",x]}),g&&(0,n.jsx)("div",{className:"bg-white/10 border border-white/20 rounded-xl p-4 text-blue-200",children:"Loading graph…"}),v&&(0,n.jsx)("div",{className:"bg-white/10 border border-white/20 rounded-xl p-4 text-red-400",children:v}),m&&(0,n.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,n.jsx)("div",{className:"col-span-3 bg-white/10 border border-white/20 rounded-xl p-2 h-[70vh] text-blue-200",children:(0,n.jsx)(a,{graph:m,highlightedNodeId:y,onNodeSelect:w})}),(0,n.jsxs)("div",{className:"col-span-1 bg-white/10 border border-white/20 rounded-xl p-4 h-[70vh] overflow-auto text-blue-200 space-y-3",children:[(0,n.jsx)("div",{className:"text-white font-semibold text-lg",children:"Details"}),(0,n.jsxs)("div",{className:"text-blue-200 text-sm mb-2",children:["Nodes: ",Object.keys(m.nodes||{}).length]}),(0,n.jsxs)("div",{className:"text-blue-200 text-sm mb-2",children:["Gas: ",null==(t=m.gasTotals)?void 0:t.gasUsed]}),y&&(0,n.jsxs)("div",{className:"relative rounded-xl overflow-hidden border border-white/20",children:[(0,n.jsx)("div",{className:"".concat((null==(s=m.nodes[y])?void 0:s.status)==="revert"?"bg-red-600":"bg-green-600"," h-1 w-full")}),(0,n.jsxs)("div",{className:"p-3 space-y-1 bg-white/5 backdrop-blur",children:[(0,n.jsxs)("div",{className:"text-white text-sm font-medium",children:["Node ",y]}),(0,n.jsx)("div",{className:"text-blue-200 text-xs break-all",children:(null==(o=m.nodes[y])?void 0:o.functionName)||(null==(d=m.nodes[y])?void 0:d.type)}),(0,n.jsxs)("div",{className:"text-blue-200 text-xs font-mono",children:["to: ",(c=null==(i=m.nodes[y])?void 0:i.to)?c.slice(0,6)+"…"+c.slice(-4):""]}),(0,n.jsxs)("div",{className:"text-blue-200 text-xs",children:["gasUsed: ",null==(u=m.nodes[y])?void 0:u.gasUsed]})]})]})]}),(0,n.jsxs)("div",{className:"col-span-4 bg-white/10 border border-white/20 rounded-xl p-3 text-blue-200",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)("button",{className:"px-3 py-1 rounded-md bg-blue-600 hover:bg-blue-500 text-white text-xs",onClick:()=>O(e=>!e),children:P?"Pause":"Play"}),(0,n.jsx)("input",{type:"range",min:0,max:Math.max(0,N.length-1),value:S,onChange:e=>{let t=Number(e.target.value);k(t);let s=N[t];(null==s?void 0:s.nodeId)&&w(s.nodeId)},className:"w-full accent-blue-400"}),(0,n.jsxs)("div",{className:"text-xs text-blue-300 whitespace-nowrap",children:["Step ",S+1,"/",Math.max(1,N.length)]})]}),N[S]&&(0,n.jsxs)("div",{className:"mt-2 text-xs text-blue-300",children:["node: ",(0,n.jsx)("span",{className:"font-mono text-blue-200",children:N[S].nodeId}),void 0!==N[S].gasUsedCumulative&&(0,n.jsxs)("span",{className:"ml-4",children:["gas cumulative: ",N[S].gasUsedCumulative]})]})]})]})]}),(0,n.jsx)(r,{})]})}},7357:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let n=s(5155),l=s(2115),r=s(2146);function a(e){return{default:e&&"default"in e?e.default:e}}s(255);let o={loader:()=>Promise.resolve(a(()=>null)),loading:null,ssr:!0},d=function(e){let t={...o,...e},s=(0,l.lazy)(()=>t.loader().then(a)),d=t.loading;function i(e){let a=d?(0,n.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,o=!t.ssr||!!t.loading,i=o?l.Suspense:l.Fragment,u=t.ssr?(0,n.jsxs)(n.Fragment,{children:[null,(0,n.jsx)(s,{...e})]}):(0,n.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(s,{...e})});return(0,n.jsx)(i,{...o?{fallback:a}:{},children:u})}return i.displayName="LoadableComponent",i}},7828:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return n}});let n=(0,s(4054).createAsyncLocalStorage)()}},e=>{e.O(0,[441,964,358],()=>e(e.s=5399)),_N_E=e.O()}]);